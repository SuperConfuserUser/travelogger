<section class="trips" data-page="trips-form">
  <%= yield %>
  <%= error_alert(trip.errors) %>

  <div class="form">
    <%= form_for trip do |f| %>

      <%= f.hidden_field :user_id %>

      <%= f.text_field :name, placeholder: "Name" %> 
      <%= error_message("Name", trip.errors[:name]) %>
      <br>
    
      <!-- how to call only the first field or makes sure it runs once -->
      <!-- name = "trip[locations_attributes][0][name]" id="trip_locations_attributes_0_name" -->
      <div id="locations">
      <%= f.fields_for :locations do |location_form| %>
        <%= add_error_div(trip.errors[:locations].any?) do %>
          <%= location_form.text_field :name, placeholder: "Location" %>
        <% end %>
      <% end %>
      </div>
      <!-- add = back in ... <% f.submit "+", class: "circle-button" %> -->
      <button id="add-location" class="circle-button">+</button>
      <%= error_message("Location", trip.errors[:locations]) %>
      <br>

      <%= f.date_field :start_date, start_year: Date.today.year - 25, end_year: Date.today.year, order: [:month, :day, :year]
      %>
      <%= error_message("Start date", trip.errors[:start_date]) %>
      to &nbsp;

      <%= f.date_field :end_date, start_year: Date.today.year - 25, end_year: Date.today.year, order: [:month, :day, :year] %> (end date optional)
      <%= error_message("End date", trip.errors[:end_date]) %>
      <br>

      <%= f.text_area :note, placeholder: "Note (optional)" %>
      <%= error_message("Note", trip.errors[:note]) %>
      <br>
        
      <h3>Categories</h3>

      <!-- custom checkbox and how to display errors?? -->
          <!-- name = "trip[locations_attributes][0][name]" id="trip_locations_attributes_0_name" -->

      <%= f.collection_check_boxes :category_ids, Category.all, :id, :name do |category| 
      %>
        <%= category.check_box %> <%= category.label %>
        <div id="category_description_<%= category.value %>"></div>
      <% end %>
      <%= error_message("Categories", trip.errors[:categories]) %>
      <br><br>

      <!-- trip.trip_categories.build(category_id: <pull from data-category_id)>, description: <value from the text input>).save -->

      
      <!-- 
        TODO:
        allow user to create custom category use find or create in the text field, this shouldn't be another checkbox. it's a nested form.

        add this field after the checkboxes. show on checkbox: true. use the JS power

        <%= f.fields_for :categories, trip.categories.build do |categories_fields| %>
          <%= categories_fields.text_field :name, placeholder: "Custom Category" %>
        <% end %> 
    -->

    <br><br>

    <!-- <%= f.fields_for :trip_categories, trip.trip_categories.build do |trip_categories_fields| %>
      <%= trip_categories_fields.text_area :description, placeholder: "Trip Category Note (optional)" %>
    <% end %> -->

      <%= f.submit form_submit_text(trip) %>

    <% end %>

  </div><!-- form -->
</section><!-- trips -->

<%= render 'trip_show_template' %>

  